<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Calculadora de Produção de Asfalto</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin: 0; 
      padding: 0;
      background: #f4f4f4;
    }
    .container { max-width: 920px; margin: 0 auto; padding: 20px; }

    h2 { font-size: 1.5rem; text-align: center; margin-bottom: 8px; }
    p { font-size: 1rem; text-align: center; margin-bottom: 12px; }

    .card { background:#fff; border-radius:12px; padding:16px; box-shadow:0 0 10px rgba(0,0,0,.07); }
    .grid { display:grid; grid-template-columns: repeat(12, 1fr); gap:12px; }
    .col-12{grid-column: span 12;} 
    .col-4{grid-column: span 4;}

    label { display:block; font-size:.9rem; margin-bottom:6px; color:#333; }
    input[type="text"], input[type="number"] { 
      padding: 12px; 
      width: 100%; 
      font-size: 1.05rem; 
      border-radius: 8px;
      border: 2px solid #ccc;
      box-sizing: border-box;
      text-align: center;
      background:#fff;
    }
    input[readonly]{ background:#f5f5f5; }
    button { 
      padding: 14px; 
      width: 100%; 
      font-size: 1.1rem; 
      border-radius: 8px;
      background-color: #007bff; 
      color: #fff; 
      border: none; 
      cursor: pointer; 
      font-weight: bold;
    }
    button:hover { background-color: #0056b3; }

    .result { 
      background: #fff; 
      padding: 16px; 
      margin-top: 15px; 
      border-radius: 12px; 
      font-size: 1rem;
      line-height: 1.45;
      box-shadow: 0 0 10px rgba(0,0,0,0.08);
    }
    .muted { color:#555; font-size: .9rem; text-align:center; margin-top:8px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Calculadora de Produção de Asfalto</h2>
    <p>Preencha o orçamento, utilize o traço definido e calcule a produção estimada.</p>

    <div class="card" style="margin-bottom:12px;">
      <label for="valorDisponivel">Valor disponível (R$)</label>
      <input type="text" id="valorDisponivel" placeholder="Ex: 50.000,00" inputmode="numeric" />
    </div>

    <div class="card" style="margin-bottom:12px;">
      <h3 style="margin:0 0 10px 0; font-size:1.05rem;">Traço fixo do agregado</h3>

      <div class="grid" style="margin-bottom:10px;">
        <div class="col-4">
          <label>Brita 0 (% sobre o agregado)</label>
          <input type="number" value="40.0" readonly />
        </div>
        <div class="col-4">
          <label>Pó de pedra (% sobre o agregado)</label>
          <input type="number" value="42.0" readonly />
        </div>
        <div class="col-4">
          <label>Areia (% sobre o agregado)</label>
          <input type="number" value="18.0" readonly />
        </div>
      </div>

      <div class="grid">
        <div class="col-4">
          <label for="percEmulsao">% Emulsão RL-1C (sobre o agregado)</label>
          <input type="number" id="percEmulsao" min="0" max="20" step="0.1" value="9" />
        </div>
      </div>

      <p class="muted">
        Agregado base = 1.000 kg (40% brita 0, 42% pó, 18% areia).  
        Emulsão RL-1C = percentual aplicado sobre o agregado (1% = 10 kg).
      </p>
    </div>

    <div class="card">
      <button id="btnCalcular">Calcular</button>
    </div>

    <div id="resultado" class="result"></div>

    <p class="muted">
      Preços (R$/t): Brita 0 = 120,00 • Pó = 75,00 • Areia = 44,50 • Emulsão RL-1C = 3.900,00.  
      Densidades (t/m³): Brita = 1.80 • Pó = 1.80 • Areia = 1.50 • Emulsão RL-1C = 1.02 • Mistura = 1.89.  
      Inclui acréscimo de <strong>12% de mão de obra</strong>.
    </p>
  </div>

  <script>
    // ------- Utilidades -------
    function formatarBR(valor) {
      return (isFinite(valor) ? Number(valor) : 0).toLocaleString('pt-BR', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      });
    }
    function desformatarBR(valor) {
      const limpo = valor.replace(/\./g, '').replace(',', '.').replace(/[^0-9.]/g, '');
      return parseFloat(limpo) || 0;
    }

    // ------- Valores dos insumos -------
    const precoTonBrita = 120.00;
    const precoTonPo = 75.00;
    const precoTonAreia = 44.50;   // ajustado
    const precoTonEmulsao = 3900.00;

    const densMisturaRef = 1.89;

    const percMaoDeObra = 0.12;

    document.getElementById("valorDisponivel")
      .addEventListener("input", function () {
        const dig = this.value.replace(/\D/g, '');
        const val = (parseInt(dig || '0', 10) / 100).toFixed(2);
        this.value = Number(val).toLocaleString("pt-BR", { minimumFractionDigits: 2 });
      });

    document.getElementById('btnCalcular').addEventListener('click', calcular);

    function calcularLote(percEmulsao) {
      const A = 1000; // agregado base

      const massaBrita = A * 0.40;
      const massaPo = A * 0.42;
      const massaAreia = A * 0.18;

      const massaEmulsao = percEmulsao * 10;

      const massaMistura = A + massaEmulsao;

      const custoLoteMateriais =
          (massaBrita / 1000) * precoTonBrita +
          (massaPo / 1000) * precoTonPo +
          (massaAreia / 1000) * precoTonAreia +
          (massaEmulsao / 1000) * precoTonEmulsao;

      const volumeMistura = (massaMistura / 1000) / densMisturaRef;

      const custoTonMisturaMateriais = custoLoteMateriais * (1000 / massaMistura);

      return {
        massaBrita, massaPo, massaAreia, massaEmulsao,
        massaMistura, volumeMistura,
        custoTonMisturaMateriais,
        m3PorTon: 1 / densMisturaRef,
        densMistura: densMisturaRef
      };
    }

    function calcular() {
      const valorDisponivel = desformatarBR(document.getElementById("valorDisponivel").value);
      const percEmulsao = Number(document.getElementById("percEmulsao").value);

      const r = calcularLote(percEmulsao);

      const custoTonMateriais = r.custoTonMisturaMateriais;
      const custoTonTotal = custoTonMateriais * (1 + percMaoDeObra);

      const toneladasMistura = valorDisponivel / custoTonTotal;
      const m3Asfalto = toneladasMistura * r.m3PorTon;

      const fracBrita = r.massaBrita / r.massaMistura;
      const fracPo = r.massaPo / r.massaMistura;
      const fracAreia = r.massaAreia / r.massaMistura;
      const fracEmulsao = r.massaEmulsao / r.massaMistura;

      const tBrita = toneladasMistura * fracBrita;
      const tPo = toneladasMistura * fracPo;
      const tAreia = toneladasMistura * fracAreia;
      const tEmulsao = toneladasMistura * fracEmulsao;

      const valorBrita = tBrita * precoTonBrita;
      const valorPo = tPo * precoTonPo;
      const valorAreia = tAreia * precoTonAreia;
      const valorEmulsao = tEmulsao * precoTonEmulsao;

      const totalMateriais = valorBrita + valorPo + valorAreia + valorEmulsao;
      const totalComMO = totalMateriais * (1 + percMaoDeObra);

      const area3 = m3Asfalto / 0.03;
      const area4 = m3Asfalto / 0.04;
      const area5 = m3Asfalto / 0.05;

      const comp3 = area3 / 7;
      const comp4 = area4 / 7;
      const comp5 = area5 / 7;

      const custoM3Total = custoTonTotal / r.m3PorTon;
      const custoM2_3 = custoM3Total * 0.03;
      const custoM2_4 = custoM3Total * 0.04;
      const custoM2_5 = custoM3Total * 0.05;

      document.getElementById('resultado').innerHTML = `
        <h3>Resultados</h3>

        <p><strong>Produção estimada:</strong> ${formatarBR(m3Asfalto)} m³  
        (${formatarBR(toneladasMistura)} t de mistura pronta)</p>

        <h3>Traço por tonelada de mistura</h3>
        <ul>
          <li>Brita 0: ${formatarBR(fracBrita * 1000)} kg</li>
          <li>Pó de pedra: ${formatarBR(fracPo * 1000)} kg</li>
          <li>Areia: ${formatarBR(fracAreia * 1000)} kg</li>
          <li>Emulsão RL-1C: ${formatarBR(fracEmulsao * 1000)} kg</li>
        </ul>

        <h3>Áreas pavimentadas</h3>
        <ul>
          <li>3 cm: ${formatarBR(area3)} m² (${formatarBR(comp3)} m de extensão a 7 m de largura)</li>
          <li>4 cm: ${formatarBR(area4)} m² (${formatarBR(comp4)} m)</li>
          <li>5 cm: ${formatarBR(area5)} m² (${formatarBR(comp5)} m)</li>
        </ul>

        <h3>Custos</h3>
        <ul>
          <li>Custo por tonelada (total): R$ ${formatarBR(custoTonTotal)}</li>
          <li>Custo por m³ (total): R$ ${formatarBR(custoM3Total)}</li>
          <li>Custo por m² (3 cm): R$ ${formatarBR(custoM2_3)}</li>
          <li>Custo por m² (4 cm): R$ ${formatarBR(custoM2_4)}</li>
          <li>Custo por m² (5 cm): R$ ${formatarBR(custoM2_5)}</li>
        </ul>

        <h3>Insumos totais</h3>
        <ul>
          <li>Brita 0: ${formatarBR(tBrita)} t — R$ ${formatarBR(valorBrita)}</li>
          <li>Pó de pedra: ${formatarBR(tPo)} t — R$ ${formatarBR(valorPo)}</li>
          <li>Areia: ${formatarBR(tAreia)} t — R$ ${formatarBR(valorAreia)}</li>
          <li>Emulsão RL-1C: ${formatarBR(tEmulsao)} t — R$ ${formatarBR(valorEmulsao)}</li>
          <li><strong>Total materiais:</strong> R$ ${formatarBR(totalMateriais)}</li>
          <li><strong>Total com 12% M.O.:</strong> R$ ${formatarBR(totalComMO)}</li>
        </ul>
      `;
    }
  </script>
</body>
</html>
